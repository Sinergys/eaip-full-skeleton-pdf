# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è OCR

## –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω

```bash
cd eaip_full_skeleton/services/ingest
python -m uvicorn main:app --reload --port 8001
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å:
```bash
curl http://localhost:8001/health
```

–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç: `{"service": "ingest", "status": "ok"}`

### 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: **http://localhost:8001/web/upload**

2. –í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (JPG, PNG)
   - –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Test Enterprise")
   - –í—ã–±–µ—Ä–∏—Ç–µ "–í–∏–¥ —ç–Ω–µ—Ä–≥–æ—Ä–µ—Å—É—Ä—Å–∞" (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ü—Ä–æ—á–µ–µ")
   - –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

3. –ù–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª"

4. –î–æ–∂–¥–∏—Ç–µ—Å—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ (OCR –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 10-30 —Å–µ–∫—É–Ω–¥)

5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
   - ‚úÖ –î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è —Å–µ–∫—Ü–∏—è "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è"
   - ‚úÖ –î–æ–ª–∂–Ω–æ –±—ã—Ç—å "OCR: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ"
   - ‚úÖ –î–æ–ª–∂–µ–Ω –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç

### 3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
pip install requests

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º
python test_image_ocr.py –ø—É—Ç—å/–∫/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é.jpg
```

**–ü—Ä–∏–º–µ—Ä:**
```bash
python test_image_ocr.py test_image.jpg
```

### 4. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

–ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –µ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ:

```python
from PIL import Image, ImageDraw, ImageFont

# –°–æ–∑–¥–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å —Ç–µ–∫—Å—Ç–æ–º
img = Image.new('RGB', (800, 600), color='white')
draw = ImageDraw.Draw(img)

# –ü—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç –¥–ª—è —Ç–µ—Å—Ç–∞
text = "–¢–µ—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç\n–≠–Ω–µ—Ä–≥–æ–∞—É–¥–∏—Ç\n2024 –≥–æ–¥\n–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ: 1000 –∫–í—Ç¬∑—á"

# –†–∏—Å—É–µ–º —Ç–µ–∫—Å—Ç
draw.text((50, 50), text, fill='black')

# –°–æ—Ö—Ä–∞–Ω—è–µ–º
img.save('test_image.jpg')
print("‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ: test_image.jpg")
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:
```bash
python create_test_image.py
```

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ API –Ω–∞–ø—Ä—è–º—É—é

```bash
# –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
curl -X POST http://localhost:8001/web/upload \
  -F "file=@test_image.jpg" \
  -F "enterprise_name=Test Enterprise" \
  -F "resource_type=other" \
  -o response.json

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–∑–∞–º–µ–Ω–∏—Ç–µ BATCH_ID)
curl http://localhost:8001/ingest/parse/BATCH_ID | python -m json.tool

# –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞
curl http://localhost:8001/ingest/parse/BATCH_ID/summary
```

## –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è

### ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (.jpg, .jpeg, .png)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ MIME-—Ç–∏–ø–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ (–¥–æ 50 –ú–ë)

### ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ PIL
- –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ (–∫–æ–Ω—Ç—Ä–∞—Å—Ç +50%, —Ä–µ–∑–∫–æ—Å—Ç—å +20%)
- OCR —á–µ—Ä–µ–∑ pytesseract (—Ä—É—Å—Å–∫–∏–π + –∞–Ω–≥–ª–∏–π—Å–∫–∏–π)
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞

### ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
- –°—Ç–∞—Ç—É—Å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è (success/error)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (—Ä–∞–∑–º–µ—Ä, —Ä–µ–∂–∏–º)
- –§–ª–∞–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è OCR

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏ –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:

```json
{
  "parsing": {
    "parsed": true,
    "data": {
      "text": "–†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç...",
      "char_count": 1234,
      "ocr_used": true,
      "image_size": [800, 600],
      "image_mode": "RGB"
    }
  }
}
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### ‚ùå –û—à–∏–±–∫–∞ "OCR –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"

**–ü—Ä–∏—á–∏–Ω–∞:** pytesseract –∏–ª–∏ Pillow –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

**–†–µ—à–µ–Ω–∏–µ:**
```bash
pip install pytesseract pillow pdf2image
```

–¢–∞–∫–∂–µ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Tesseract OCR:
- **Windows:** –°–∫–∞—á–∞–π—Ç–µ —Å https://github.com/UB-Mannheim/tesseract/wiki
- **Linux:** `sudo apt-get install tesseract-ocr tesseract-ocr-rus`
- **macOS:** `brew install tesseract tesseract-lang`

### ‚ùå –û—à–∏–±–∫–∞ "–°–µ—Ä–≤–∏—Å –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç"

**–ü—Ä–∏—á–∏–Ω–∞:** –°–µ—Ä–≤–∏—Å –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –ø–æ—Ä—Ç –∑–∞–Ω—è—Ç

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∑–∞–ø—É—â–µ–Ω –ª–∏ —Å–µ—Ä–≤–∏—Å
netstat -an | findstr 8001

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å
cd eaip_full_skeleton/services/ingest
python -m uvicorn main:app --reload --port 8001
```

### ‚ùå OCR –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —Ç–µ–∫—Å—Ç

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–ª–æ—Ö–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–ª–∏ –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —è–∑—ã–∫

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á–µ—Ç–∫–æ–µ –∏ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —è–∑—ã–∫–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã –¥–ª—è Tesseract (rus, eng)
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (—É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–Ω—Ç—Ä–∞—Å—Ç, —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ)

## –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–∞. –û–∂–∏–¥–∞–µ–º—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ OCR:

```
INFO: –ù–∞—á–∏–Ω–∞—é OCR –æ–±—Ä–∞–±–æ—Ç–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: /path/to/image.jpg
INFO: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ: 800x600 –ø–∏–∫—Å–µ–ª–µ–π, —Ä–µ–∂–∏–º: RGB
DEBUG: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: –∫–æ–Ω—Ç—Ä–∞—Å—Ç +50%, —Ä–µ–∑–∫–æ—Å—Ç—å +20%
INFO: OCR –∑–∞–≤–µ—Ä—à–µ–Ω: –∏–∑–≤–ª–µ—á–µ–Ω–æ 1234 —Å–∏–º–≤–æ–ª–æ–≤
```

## –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã

–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Ç–µ–∫—Å—Ç–æ–º:
- –°–∫–∞–Ω—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (JPG, PNG)
- –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –°–∫—Ä–∏–Ω—à–æ—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–º

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ: –º–∏–Ω–∏–º—É–º 300 DPI –¥–ª—è –ª—É—á—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞
- –ö–æ–Ω—Ç—Ä–∞—Å—Ç: —á–µ—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–∞ –±–µ–ª–æ–º —Ñ–æ–Ω–µ
- –§–æ—Ä–º–∞—Ç: JPG –∏–ª–∏ PNG

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ OCR –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

