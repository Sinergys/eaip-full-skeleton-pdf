# EAIP ingest
–°–µ—Ä–≤–∏—Å –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–æ–≤ –¥–ª—è EAIP.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ (Excel, PDF, Word, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
- **üß† Intelligent Router** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤
- –ü–∞—Ä—Å–∏–Ω–≥ –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–æ–≤
- OCR –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ —ç–Ω–µ—Ä–≥–æ—Ä–µ—Å—É—Ä—Å–∞–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö SQLite
- **üîß –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–µ–∂–∏–º–æ–≤** - debug/production –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

## –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç:
- **–û—Ç—Ä–∞—Å–ª—å** (`industry`) ‚Äî –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –Ω–∞–∑–≤–∞–Ω–∏–π —Ñ–∞–π–ª–æ–≤ –∏ –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è
- **–¢–∏–ø –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è** (`enterprise_type`) ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –¢–≠–°, –ì–≠–°, —Ö–∏–º–∏—á–µ—Å–∫–∏–π –∑–∞–≤–æ–¥
- **–¢–∏–ø –ø—Ä–æ–¥—É–∫—Ü–∏–∏** (`product_type`) ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏—è, —Ö–∏–º–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–¥—É–∫—Ü–∏—è

–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É—á–∏—Ç—ã–≤–∞–µ—Ç:
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (–µ—Å–ª–∏ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ –µ—Å—Ç—å "–¢–≠–°" ‚Üí —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞)
- –ö–æ–Ω—Ç–µ–∫—Å—Ç —Ñ–∞–π–ª–æ–≤ (—Ñ–∞–π–ª—ã –ø—Ä–æ —Å–∞–º–æ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ –≤–∞–∂–Ω–µ–µ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π)
- –í–∑–≤–µ—à–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –æ—Ç—Ä–∞—Å–ª–µ–π –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö —Ñ–∞–π–ª–æ–≤

## –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –∏–∑ PDF

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∏–∑ PDF:
- **Tabula** (—Ç—Ä–µ–±—É–µ—Ç Java) ‚Äî –ª—É—á—à–∏–π –º–µ—Ç–æ–¥ –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
- **pdfplumber** ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥
- **Camelot** ‚Äî –¥–ª—è —Ç–∞–±–ª–∏—Ü —Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- Java Runtime Environment (JRE) –≤–µ—Ä—Å–∏–∏ 11+ –¥–ª—è —Ä–∞–±–æ—Ç—ã Tabula
- jpype1 –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã Tabula (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Java:**
- Windows: `winget install Microsoft.OpenJDK.17`
- Linux: `sudo apt-get install default-jre`
- macOS: `brew install openjdk`

–°–º. `docs/JAVA_INSTALLATION_GUIDE.md` –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π.

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–Ω–µ—Ä–≥–æ–ø–∞—Å–ø–æ—Ä—Ç–∞

–î–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —ç–Ω–µ—Ä–≥–æ–ø–∞—Å–ø–æ—Ä—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
```bash
python tools/comprehensive_passport_test.py path/to/passport.xlsx --blocks all
```

–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
- –°—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–π–ª–∞ –∏ –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –ª–∏—Å—Ç–æ–≤
- –ù–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ª–∏—Å—Ç–∞—Ö
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ñ–æ—Ä–º—É–ª (–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ—à–∏–±–∫–∏ #REF!, #VALUE!, #DIV/0!)
- –°–≤—è–∑–∏ –º–µ–∂–¥—É –ª–∏—Å—Ç–∞–º–∏

–°–º. `docs/STAGE2_TESTING_CHECKLIST.md` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ —á–µ–∫–ª–∏—Å—Ç–∞.

## üß† Intelligent Router

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø—É—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏:

- **–ë—ã—Å—Ç—Ä—ã–π –∞–Ω–∞–ª–∏–∑** (2-3 —Å–µ–∫) - –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞
- **–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑** (3-5 —Å–µ–∫) - –ø—Ä–∏ –Ω–∏–∑–∫–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è** - –≤—ã–±–æ—Ä –º–æ–¥—É–ª–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç:**
- –¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞ (energy_passport, balance_act, consumption_table, –∏ —Ç.–¥.)
- –¢–∏–ø —Ä–µ—Å—É—Ä—Å–∞ (electricity, gas, water, heat, fuel, multiple)
- –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö (meter_readings, energy_balance, consumption, production, realization)
- –ü–µ—Ä–∏–æ–¥ –¥–∞–Ω–Ω—ã—Ö (2024_Q1, 2023_year, multiyear)
- –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞ (confidence 0.0-1.0)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Routing map —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î.

–°–º. `docs/INTELLIGENT_ROUTER_IMPLEMENTATION.md` –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

## üîß –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–µ–∂–∏–º–æ–≤ —Ä–∞–±–æ—Ç—ã

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ä–µ–∂–∏–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Ñ–∞–π–ª–æ–≤:

### –†–µ–∂–∏–º DEBUG (–û—Ç–ª–∞–¥–∫–∞)
- **–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –í—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ñ–∞–π–ª—ã, –¥–∞–∂–µ –µ—Å–ª–∏ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ—Ç–ª–∞–¥–∫–∞
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞:** `SYSTEM_MODE=debug` –∏–ª–∏ –≤—ã–±–æ—Ä –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

### –†–µ–∂–∏–º PRODUCTION (–†–∞–±–æ—Ç–∞)
- **–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –ü—Ä–æ–ø—É—Å–∫–∞—Ç—å —Ñ–∞–π–ª—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –ø–µ—Ä–µ–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –†–∞–±–æ—á–∏–π —Ä–µ–∂–∏–º —Å–∏—Å—Ç–µ–º—ã
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞:** `SYSTEM_MODE=production` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –∏–ª–∏ –≤—ã–±–æ—Ä –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

**–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:** –î–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤.

–°–º. `docs/SYSTEM_MODE_SWITCH.md` –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

## üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è SQLite

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã:

- ‚úÖ **WAL —Ä–µ–∂–∏–º** ‚Äî —É–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏
- ‚úÖ **29 –∏–Ω–¥–µ–∫—Å–æ–≤** ‚Äî —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ 50-200%
- ‚úÖ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** ‚Äî –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
  - `cache_size`: 64MB
  - `synchronous`: NORMAL
  - `temp_store`: MEMORY
  - `mmap_size`: 256MB

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:** `python tools/check_optimization.py`  
**–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:** `.\tools\backup_sqlite.ps1` (Windows) –∏–ª–∏ `./tools/backup_sqlite.sh` (Linux/Mac)

–°–º. `docs/SQLITE_OPTIMIZATION_GUIDE.md` –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

## Dev run
```bash
python -m venv .venv && source .venv/bin/activate
pip install -r requirements.txt
uvicorn main:app --reload --port 8001
```
