# ‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ active_kwh –∏–∑ –º–µ—Å—è—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ—â–Ω–æ—Å—Ç–∏

## –ü—Ä–æ–±–ª–µ–º–∞

–í –ª–∏—Å—Ç–µ 'Struktura pr2' –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ `electricity.active_kwh` (–ê–∫—Ç–∏–≤–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏–∏ –ø–æ –∫–≤–∞—Ä—Ç–∞–ª–∞–º), –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏–∑ –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç–∏ –ø–æ –º–µ—Å—è—Ü–∞–º.

## –†–µ—à–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ `active_kwh` –∏–∑ –º–µ—Å—è—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç–∏.

### –§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞

```
active_kwh = —Å—Ä–µ–¥–Ω—è—è_–º–æ—â–Ω–æ—Å—Ç—å_–∑–∞_–º–µ—Å—è—Ü_–∫–í—Ç √ó —á–∞—Å—ã_–≤_–º–µ—Å—è—Ü–µ √ó –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–º–µ—Å—è—Ü–µ–≤_–≤_–∫–≤–∞—Ä—Ç–∞–ª–µ
```

–ì–¥–µ:
- `—Å—Ä–µ–¥–Ω—è—è_–º–æ—â–Ω–æ—Å—Ç—å_–∑–∞_–º–µ—Å—è—Ü_–∫–í—Ç` - —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç–∏ –∑–∞ –º–µ—Å—è—Ü (–∫–í—Ç)
- `—á–∞—Å—ã_–≤_–º–µ—Å—è—Ü–µ` = 720 —á–∞—Å–æ–≤ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
- `–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–º–µ—Å—è—Ü–µ–≤_–≤_–∫–≤–∞—Ä—Ç–∞–ª–µ` = 3

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

#### 1. –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—á–µ—Ç–∞ –≤ `energy_passport_calculations.py`

- `calculate_consumption_from_monthly_power()` - —Ä–∞—Å—á–µ—Ç –º–µ—Å—è—á–Ω–æ–≥–æ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –∏–∑ –º–æ—â–Ω–æ—Å—Ç–∏
- `calculate_quarter_consumption_from_monthly_power()` - —Ä–∞—Å—á–µ—Ç –∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –∏–∑ –º–µ—Å—è—á–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç–∏

#### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_compute_quarter_totals()` –≤ `energy_aggregator.py`

- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ —Ä–∞—Å—Ö–æ–¥–µ –∞–∫—Ç–∏–≤–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç–∏ –≤ –º–µ—Å—è—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç `active_kwh` –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç, –Ω–æ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –º–æ—â–Ω–æ—Å—Ç–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π –ø–æ–ª–µ–π:
  - `active_power`
  - `power_kw`
  - `active_power_kw`
  - `—Ä–∞—Å—Ö–æ–¥_–∞–∫—Ç–∏–≤–Ω–æ–π_–º–æ—â–Ω–æ—Å—Ç–∏`
  - `–º–æ—â–Ω–æ—Å—Ç—å_–∫–≤—Ç`
  - `–º–æ—â–Ω–æ—Å—Ç—å`
  - `active_power_monthly`
  - `power_monthly`

#### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `fill_struktura_pr2()` –≤ `fill_energy_passport.py`

- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è `active_kwh` –ø–µ—Ä–µ–¥ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º
- –ï—Å–ª–∏ `active_kwh` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∏–∑ –º–µ—Å—è—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ—â–Ω–æ—Å—Ç–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–∞—Å—á–µ—Ç–∞

#### 4. –£–ª—É—á—à–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥ –ª–∏—Å—Ç–∞ "–≠–õ–ï–ö–¢–†" –≤ `energy_aggregator.py`

- –ê–Ω–∞–ª–∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ —Å –¥–∞–Ω–Ω—ã–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ —Å —Ä–∞—Å—Ö–æ–¥–æ–º –∞–∫—Ç–∏–≤–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç–∏
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –º–æ—â–Ω–æ—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ `active_power`

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

1. **–ü—Ä–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö:**
   - –ü–∞—Ä—Å–∏—Ç—Å—è –ª–∏—Å—Ç "–≠–õ–ï–ö–¢–†" (–∏–ª–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è)
   - –ò–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫–æ–ª–æ–Ω–æ–∫ (–∫–í—Ç¬∑—á, –∫–í–ê—Ä¬∑—á, —Å—Ç–æ–∏–º–æ—Å—Ç—å)
   - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ —Å —Ä–∞—Å—Ö–æ–¥–æ–º –∞–∫—Ç–∏–≤–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç–∏ (–∫–í—Ç), –æ–Ω–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ `active_power`

2. **–ü—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã—Ö –∏—Ç–æ–≥–æ–≤:**
   - –ï—Å–ª–∏ `active_kwh` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ —Ä–∞–≤–µ–Ω 0
   - –ò—â—É—Ç—Å—è –º–µ—Å—è—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–ª–µ–º –º–æ—â–Ω–æ—Å—Ç–∏ (—Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–∑–≤–∞–Ω–∏–π)
   - –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Å—Ä–µ–¥–Ω—è—è –º–æ—â–Ω–æ—Å—Ç—å –∑–∞ –º–µ—Å—è—Ü
   - –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ: `—Å—Ä–µ–¥–Ω—è—è_–º–æ—â–Ω–æ—Å—Ç—å √ó 720 √ó 3`

3. **–ü—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ –ª–∏—Å—Ç–∞ 'Struktura pr2':**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ `active_kwh` –≤ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã—Ö –∏—Ç–æ–≥–∞—Ö
   - –ï—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è —Ä–∞—Å—á–µ—Ç –∏–∑ –º–µ—Å—è—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —è—á–µ–π–∫–∞ —Å —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –î–∞–Ω–Ω—ã–µ —Å —Ä–∞—Å—Ö–æ–¥–æ–º –∞–∫—Ç–∏–≤–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç–∏

```json
{
  "electricity": {
    "2022-Q1": {
      "months": [
        {
          "month": "–Ø–Ω–≤–∞—Ä—å",
          "values": {
            "active_power": 100.5,  // –∫–í—Ç
            "cost_sum": 50000
          }
        },
        {
          "month": "–§–µ–≤—Ä–∞–ª—å",
          "values": {
            "active_power": 105.2,  // –∫–í—Ç
            "cost_sum": 52000
          }
        },
        {
          "month": "–ú–∞—Ä—Ç",
          "values": {
            "active_power": 98.7,  // –∫–í—Ç
            "cost_sum": 49000
          }
        }
      ]
    }
  }
}
```

**–†–∞—Å—á–µ—Ç:**
- –°—Ä–µ–¥–Ω—è—è –º–æ—â–Ω–æ—Å—Ç—å = (100.5 + 105.2 + 98.7) / 3 = 101.47 –∫–í—Ç
- active_kwh = 101.47 √ó 720 √ó 3 = 219,175.2 –∫–í—Ç¬∑—á

### –ü—Ä–∏–º–µ—Ä 2: –î–∞–Ω–Ω—ã–µ —Å –∫–í—Ç¬∑—á (—É–∂–µ –µ—Å—Ç—å)

```json
{
  "electricity": {
    "2022-Q1": {
      "quarter_totals": {
        "active_kwh": 200000  // –£–∂–µ –µ—Å—Ç—å, —Ä–∞—Å—á–µ—Ç –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
      }
    }
  }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ä–∞—Å—á–µ—Ç –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è.

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä—É–µ—Ç:
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–π —Ä–∞—Å—á–µ—Ç: `"–í—ã—á–∏—Å–ª–µ–Ω active_kwh –∏–∑ –º–µ—Å—è—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ—â–Ω–æ—Å—Ç–∏: X –∫–í—Ç¬∑—á"`
- ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è: –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ –º–æ—â–Ω–æ—Å—Ç–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- üîç –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –ø–æ–ª—è –º–æ—â–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- –ï—Å–ª–∏ –º–æ–¥—É–ª—å —Ä–∞—Å—á–µ—Ç–æ–≤ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback —Ñ–æ—Ä–º—É–ª–∞
- –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ –º–æ—â–Ω–æ—Å—Ç–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (0)
- –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è, –Ω–æ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—é—Ç –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è

## –°—Ç–∞—Ç—É—Å

‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é**

- –§—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—á–µ—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω—ã
- –õ–æ–≥–∏–∫–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- –§—É–Ω–∫—Ü–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ª–∏—Å—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- –ü–∞—Ä—Å–∏–Ω–≥ –ª–∏—Å—Ç–∞ —É–ª—É—á—à–µ–Ω

---

**–î–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 2025-01-XX  
**–í–µ—Ä—Å–∏—è:** 1.0

