# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–∞ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –º–µ—Å—è—á–Ω—ã—Ö

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

–ê–≥—Ä–µ–≥–∞—Ç–æ—Ä –æ–∂–∏–¥–∞–ª, —á—Ç–æ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —É–∂–µ –µ—Å—Ç—å –≤ —Ñ–∞–π–ª–µ, –Ω–æ **–æ–Ω–∏ –¥–æ–ª–∂–Ω—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å—Å—è –∏–∑ –º–µ—Å—è—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ª–æ–≥–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `_compute_quarter_totals()`:

1. **–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω —Ä–∞—Å—á–µ—Ç –∏–∑ –º–µ—Å—è—á–Ω—ã—Ö:**
   - –ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –í–°–ï–ì–î–ê —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∏–∑ –º–µ—Å—è—á–Ω—ã—Ö
   - –ù–µ –æ–∂–∏–¥–∞—é—Ç—Å—è –≥–æ—Ç–æ–≤—ã–µ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª–µ
   - –ü–µ—Ä–µ–∑–∞–ø–∏—Å—å `quarter_totals` —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

2. **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
   - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ `None` –∑–Ω–∞—á–µ–Ω–∏–π
   - –°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —á–∏—Å–ª–æ–≤—ã—Ö –ø–æ–ª–µ–π –∏–∑ –º–µ—Å—è—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–∞—Å—á–µ—Ç–∞

3. **–£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤:**
   - –£–±—Ä–∞–Ω–∞ –ª–∏—à–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞ `not active_kwh_value` (–º–æ–∂–µ—Ç –±—ã—Ç—å False –¥–ª—è 0)
   - –£–ø—Ä–æ—â–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è `active_kwh` –∏ `reactive_kvarh`

## üìù –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –î–æ:
```python
# –û–±–Ω–æ–≤–ª—è–µ–º totals (—Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è)
quarter_data["quarter_totals"].update(totals)
totals = quarter_data["quarter_totals"]  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å
```

### –ü–æ—Å–ª–µ:
```python
# –í–ê–ñ–ù–û: –ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º quarter_totals —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∏–∑ –º–µ—Å—è—á–Ω—ã—Ö
# –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–≥–¥–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∏–∑ –º–µ—Å—è—á–Ω—ã—Ö
quarter_data["quarter_totals"] = totals
```

## üîç –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

1. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Å—è—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**
   - –§—É–Ω–∫—Ü–∏—è `aggregate_months()` –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –º–µ—Å—è—Ü—ã –ø–æ –∫–≤–∞—Ä—Ç–∞–ª–∞–º
   - –°–æ–∑–¥–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É: `{quarter_key: {"months": [{"month": "...", "values": {...}}]}}`

2. **–†–∞—Å—á–µ—Ç –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã—Ö –∏—Ç–æ–≥–æ–≤:**
   - `_compute_quarter_totals()` —Å—É–º–º–∏—Ä—É–µ—Ç –≤—Å–µ —á–∏—Å–ª–æ–≤—ã–µ –ø–æ–ª—è –∏–∑ –º–µ—Å—è—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è: `quarter_total = sum(month_values)`
   - –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `quarter_totals`

3. **Fallback —Ä–∞—Å—á–µ—Ç—ã:**
   - –ï—Å–ª–∏ `active_kwh` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ —Ä–∞–≤–µ–Ω 0, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏–∑ `active_power`
   - –ï—Å–ª–∏ `reactive_kvarh` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ —Ä–∞–≤–µ–Ω 0, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏–∑ `reactive_power`

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

- ‚úÖ –ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ **–≤—Å–µ–≥–¥–∞** —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∏–∑ –º–µ—Å—è—á–Ω—ã—Ö
- ‚úÖ –ù–µ –æ–∂–∏–¥–∞—é—Ç—Å—è –≥–æ—Ç–æ–≤—ã–µ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª–µ
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ `None` –∏ –ø—É—Å—Ç—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª —Å –º–µ—Å—è—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ —Ä–∞—Å—á–µ—Ç–µ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã—Ö –∏—Ç–æ–≥–æ–≤
4. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –ø–∞—Å–ø–æ—Ä—Ç - –≤—Å–µ –ø–æ–ª—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω—ã

